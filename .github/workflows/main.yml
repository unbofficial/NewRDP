- name: Install Ngrok via Chocolatey
        run: |
          # Chocolatey se ngrok install karein (No link needed)
          choco install ngrok -y

      - name: Authenticate and Start Ngrok
        run: |
          # Ngrok authenticate karein
          ngrok config add-authtoken ${{ secrets.NGROK_AUTH_TOKEN }}
          
          # TCP tunnel start karein background mein
          Start-Process ngrok -ArgumentList "tcp 3389"
          
          # Wait karein taaki tunnel up ho jaye
          Start-Sleep -Seconds 10

      - name: Get Connection Address
        run: |
          # Local API se public address nikalne ki koshish
          $tunnels = Invoke-RestMethod http://localhost:4040/api/tunnels
          $address = $tunnels.tunnels.public_url
          
          # "tcp://" ko remove karna taaki direct RDP client mein paste ho sake
          $cleanAddress = $address.Replace("tcp://", "")
          
          Write-Host "=============================="
          Write-Host "ðŸš€ CONNECT TO THIS ADDRESS:"
          Write-Host "$cleanAddress"
          Write-Host "------------------------------"
          Write-Host "ðŸ‘¤ USERNAME: RDPUser"
          Write-Host "ðŸ”‘ PASSWORD: MySafePass123!"
          Write-Host "=============================="
          
          # Runner ko zinda rakhne ke liye loop
          while($true) { 
            Write-Host "RDP is running on $cleanAddress ... $(Get-Date)"
            Start-Sleep -Seconds 60 
          }
